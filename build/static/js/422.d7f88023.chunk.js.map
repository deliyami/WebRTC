{"version":3,"file":"static/js/422.d7f88023.chunk.js","mappings":"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","sources":["pages/chat.tsx"],"sourcesContent":["import React, { lazy, useRef, useEffect, useState } from 'react'\nimport * as Kalidokit from 'kalidokit'\nimport socketIOClient, { Socket } from 'socket.io-client'\nimport { Router, Link, useParams } from 'react-router-dom'\nimport { Camera } from '@mediapipe/camera_utils'\nimport { ExtendedCamera } from '../interfaces/extendedCamera'\nimport { \n  Clock,\n  DirectionalLight,\n  Euler,\n  PerspectiveCamera,\n  Scene,\n  Quaternion,\n  WebGLRenderer,\n  Vector3\n} from 'three'\nimport { VRM, VRMSchema, VRMUtils } from '@pixiv/three-vrm';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport { CanvasRef } from '../components/canvas'\nimport { clamp, lerp } from 'three/src/math/MathUtils'\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\n\nconst Canvas = lazy(() => import('../components/canvas'))\n\nconst SOCKET_URL = `${process.env.REACT_APP_BACKEND_HOST}:${process.env.REACT_APP_BACKEND_PORT}`\n\nconst Chat = () => {\n    // 소켓정보를 담을 Ref\n  const socketRef = useRef<Socket>()\n  // 자신의 스트림\n  const streamRef = useRef<MediaStream>()\n  // 자신의 비디오\n  const myVideoRef = useRef<HTMLVideoElement>(document.createElement('video'))\n  const myCanvasRef = useRef<HTMLCanvasElement>(null)\n  const myOldLookTarget = useRef<Euler>(new Euler())\n  const mySceneRef = useRef<Scene>(new Scene())\n  const myRendererRef = useRef<WebGLRenderer>()\n  const myOrbitCameraRef = useRef<PerspectiveCamera>()\n  const myClockRef = useRef<Clock>()\n  const myVrmRef = useRef<VRM>();\n  // 다른사람의 비디오\n  // @ts-ignore\n  const remoteResultsRef = useRef<Results>(undefined)\n  const remoteCanvasRef = useRef<HTMLCanvasElement>(null)\n  const remoteOldLookTarget = useRef<Euler>(new Euler())\n  const remoteSceneRef = useRef<Scene>(new Scene())\n  const remoteRendererRef = useRef<WebGLRenderer>()\n  const remoteOrbitCameraRef = useRef<PerspectiveCamera>()\n  const remoteClockRef = useRef<Clock>()\n  const remoteVrmRef = useRef<VRM>();\n  // const scene = useRef<Scene>(new Scene())\n\n  const [ successMyCanvas, setSuccessMyCanvas ] = useState<Boolean>(false);\n\n  // peerConnection\n  const peerRef = useRef<RTCPeerConnection>(new RTCPeerConnection({\n    iceServers: [\n      {\n        urls: 'stun:stun.l.google.com:19302',\n      },\n    ],\n  }))\n  // @ts-ignore\n  const holisticRef = useRef<Holistic>()\n  const dataChannelRef = useRef<RTCDataChannel>()\n  const { roomID } = useParams();\n\n  const checkData = (e: any) => {\n    e.preventDefault()\n    console.log(dataChannelRef.current?.readyState);\n    dataChannelRef.current?.send('hello, world!')\n    // dataChannelRef.current = peerRef.current!.createDataChannel(\"ChatRoom\")\n  }\n\n  const calculateVideo = async () => {\n    if (holisticRef.current && myVideoRef.current) {\n      await holisticRef.current.send({image: myVideoRef.current});\n    }\n  }\n  const myAnimate = async () => {\n    await calculateVideo()\n    \n    if (!(myClockRef.current && myRendererRef.current && myOrbitCameraRef.current)) return\n    if (myVrmRef.current) {\n      myVrmRef.current.update(myClockRef.current.getDelta());\n    }\n    myRendererRef.current.render(mySceneRef.current, myOrbitCameraRef.current);\n    remoteAnimate()\n    requestAnimationFrame(myAnimate)\n  }\n  const remoteAnimate = async () => {\n    if (remoteResultsRef.current) remoteResults(remoteResultsRef.current)\n    \n    if (!(remoteClockRef.current && remoteRendererRef.current && remoteOrbitCameraRef.current)) return\n    if (remoteVrmRef.current) {\n      await remoteVrmRef.current.update(remoteClockRef.current.getDelta());\n    }\n    await remoteRendererRef.current.render(remoteSceneRef.current, remoteOrbitCameraRef.current);\n  }\n  \n  const setMedia = async () => {\n    try {\n      // @ts-ignore\n      const holistic = await new Holistic({locateFile: (file) => {\n        return `https://cdn.jsdelivr.net/npm/@mediapipe/holistic@0.5.1635989137/${file}`;\n      }});\n      holistic.setOptions({\n        modelComplexity: 1,\n        smoothLandmarks: true,\n        minDetectionConfidence: 0.7,\n        minTrackingConfidence: 0.7,\n        refineFaceLandmarks: true,\n      })\n      holisticRef.current = holistic\n\n      const myCamera = await new Camera(myVideoRef.current!, {\n        onFrame: async () => {\n          // await holistic.send({image: myVideoRef.current!});\n        },\n        width: 640,\n        height: 480\n      }) as ExtendedCamera\n      await myCamera.start()\n      const stream = myCamera.g\n      \n      streamRef.current = stream\n      myVideoRef.current.srcObject = stream\n    } catch (e) {\n      console.error(e)\n    }\n  }\n  \n  const getMyModel = async () => {\n    const loader = new GLTFLoader();\n    loader.crossOrigin = \"anonymous\";\n    // Import model from URL, add your own model here\n    await loader.load(\n      \"https://cdn.glitch.com/29e07830-2317-4b15-a044-135e73c7f840%2FAshtra.vrm?v=1630342336981\",\n      async gltf => {\n        await VRMUtils.removeUnnecessaryJoints(gltf.scene);\n        await VRM.from(gltf).then(v => {\n          mySceneRef.current.add(v.scene);\n          myVrmRef.current = v\n          myVrmRef.current.scene.rotation.y = Math.PI;\n        });\n      },\n\n      progress =>\n        console.log(\n          \"Loading model...\",\n          100.0 * (progress.loaded / progress.total),\n          \"%\"\n        ),\n\n      error => console.error(error)\n    );\n  }\n  const setMyThree =  () => {\n    myRendererRef.current = new WebGLRenderer({\n      canvas: myCanvasRef.current!,\n      alpha:true\n    });\n    myRendererRef.current.setPixelRatio(window.devicePixelRatio);\n\n    // camera\n    myOrbitCameraRef.current = new PerspectiveCamera(35, 300 / 225, 0.1, 1000);\n    myOrbitCameraRef.current.position.set(-0.1, 1.4, 0.7);\n\n    // controls\n    const orbitControls = new OrbitControls(myOrbitCameraRef.current, myRendererRef.current.domElement);\n    orbitControls.screenSpacePanning = true;\n    orbitControls.target.set(-0.1, 1.4, 0.0);\n    orbitControls.update();\n\n    // light\n    const light = new DirectionalLight(0xffffff);\n    light.position.set(1.0, 1.0, 1.0).normalize();\n    mySceneRef.current.add(light);\n    myClockRef.current = new Clock()\n  }\n\n  const getRemoteModel = async () => {\n    const loader = new GLTFLoader();\n    loader.crossOrigin = \"anonymous\";\n    // Import model from URL, add your own model here\n    await loader.load(\n      \"https://cdn.glitch.com/29e07830-2317-4b15-a044-135e73c7f840%2FAshtra.vrm?v=1630342336981\",\n      async gltf => {\n        await VRMUtils.removeUnnecessaryJoints(gltf.scene);\n        await VRM.from(gltf).then(v => {\n          remoteSceneRef.current.add(v.scene);\n          remoteVrmRef.current = v\n          remoteVrmRef.current.scene.rotation.y = Math.PI;\n        });\n      },\n\n      progress =>\n        console.log(\n          \"Loading Remote model...\",\n          100.0 * (progress.loaded / progress.total),\n          \"%\"\n        ),\n\n      error => console.error(error)\n    );\n  }\n  const setRemoteThree =  () => {\n    remoteRendererRef.current = new WebGLRenderer({\n      canvas: remoteCanvasRef.current!,\n      alpha:true\n    });\n    remoteRendererRef.current.setPixelRatio(window.devicePixelRatio);\n\n    // camera\n    remoteOrbitCameraRef.current = new PerspectiveCamera(35, 300 / 225, 0.1, 1000);\n    remoteOrbitCameraRef.current.position.set(-0.1, 1.4, 0.7);\n\n    // controls\n    const orbitControls = new OrbitControls(remoteOrbitCameraRef.current, remoteRendererRef.current.domElement);\n    orbitControls.screenSpacePanning = true;\n    orbitControls.target.set(-0.1, 1.4, 0.0);\n    orbitControls.update();\n\n    // light\n    const light = new DirectionalLight(0xffffff);\n    light.position.set(1.0, 1.0, 1.0).normalize();\n    remoteSceneRef.current.add(light);\n\n    // async function animate() {\n    //   if (holisticRef.current && videoRef.current)\n    //   await holisticRef.current.send({image: videoRef.current});\n    // }\n    remoteClockRef.current = new Clock()\n  }\n  const setPeer = () => {\n    if (!(peerRef.current && streamRef.current)) return\n      // 스트림을 peerConnection에 등록\n      peerRef.current.addTrack(streamRef.current.getTracks()[0])\n\n      // iceCandidate 이벤트 \n      peerRef.current.onicecandidate = (e) => {\n        console.log('try candidate');\n        if (e.candidate) {\n          if (!socketRef.current) {\n            return;\n          }\n          console.log('receive candidate');\n          socketRef.current.emit('candidate', e.candidate, roomID);\n        }\n        // dataChannel.send('hello, world!')\n        console.log('ok candidate')\n      };\n      console.log('set peer data channel handler');\n      peerRef.current.ondatachannel = (e: RTCDataChannelEvent) => {\n        console.log('try peer data channel', e);\n        dataChannelRef.current = e.channel\n        dataChannelRef.current.onmessage = (e) => {\n          remoteResultsRef.current = JSON.parse(e.data)\n          // console.log('on message', remoteResultsRef.current)\n          // remoteResultsRef.current\n        }\n        dataChannelRef.current.onopen = () => {\n          console.log('open channel');\n        }\n      }\n\n      // 구 addStream 현 track 이벤트 \n      peerRef.current.ontrack = (e) => {\n        console.log('wow');\n        // if (remoteVideoRef.current) {\n        //   remoteVideoRef.current.srcObject = e.streams[0];\n        // }\n      }\n  }\n  const setSocket = () => {\n    // Socket connect\n    // socketRef.current = socketIOClient(SOCKET_URL)\n    if(!socketRef.current) return\n    // 마운트시 해당 방의 roomID을 서버에 전달\n    socketRef.current!.emit('join_room', {\n      room: roomID,\n    });\n      \n    // 기존 유저가 있고, 새로운 유저가 들어왔다면 오퍼생성\n    socketRef.current.on('all_users', (allUsers: Array<{ id: string }>) => {\n      console.log('hello, new User!');\n      if (allUsers.length > 0) {\n        createOffer();\n      }\n    });\n  \n    // offer를 전달받은 PeerB만 해당됩니다\n    // offer를 들고 만들어둔 answer 함수 실행\n    socketRef.current.on('getOffer', (sdp: RTCSessionDescription) => {\n      console.log('receive Offer');\n      console.log('another user offer', sdp);\n      createAnswer(sdp);\n    });\n    \n    // answer를 전달받을 PeerA만 해당됩니다.\n    // answer를 전달받아 PeerA의 RemoteDescription에 등록\n    socketRef.current.on('getAnswer', (sdp: RTCSessionDescription) => {\n      console.log('receive Answer');\n      console.log('another user offer', sdp);\n      if (!peerRef.current) {\n        return;\n      }\n      peerRef.current.setRemoteDescription(sdp);\n    });\n    \n    // 서로의 candidate를 전달받아 등록\n    socketRef.current.on('getCandidate', async (candidate: RTCIceCandidate) => {\n      if (!peerRef.current) {\n        return;\n      }\n      console.log('get candidate')\n      await peerRef.current.addIceCandidate(candidate);\n    });\n\n    socketRef.current.on('user_exit', async () => {\n      console.log('user exit')\n    })\n  }\n\n  const createOffer = async () => {\n    console.log('create Offer');\n    dataChannelRef.current = peerRef.current!.createDataChannel(\"ChatRoom\")\n    dataChannelRef.current.onmessage = (e) => {\n      \n      remoteResultsRef.current = JSON.parse(e.data)\n      // console.log('on message', remoteResultsRef.current);\n      // remoteResultsRef...\n    }\n    dataChannelRef.current.onopen = () => {\n      console.log('open channel');\n    }\n    \n    if (!(peerRef.current && socketRef.current)) {\n      return;\n    }\n    try {\n      // offer 생성\n      const sdp = await peerRef.current.createOffer();\n      // 자신의 sdp로 LocalDescription 설정\n      peerRef.current.setLocalDescription(sdp);\n      console.log('sent the offer');\n      console.log('my offer', sdp);\n      // offer 전달\n      socketRef.current.emit('offer', sdp, roomID);\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  \n  const createAnswer = async (sdp: RTCSessionDescription) => {\n    // sdp : PeerA에게서 전달받은 offer\n    console.log('create Answer');\n    \n    if (!(peerRef.current && socketRef.current)) {\n      return;\n    }\n\n    try {\n      // PeerA가 전달해준 offer를 RemoteDescription에 등록해 줍시다.\n      peerRef.current.setRemoteDescription(sdp);\n      \n      // answer생성해주고\n      const answerSdp = await peerRef.current.createAnswer();\n      \n      // answer를 LocalDescription에 등록해 줍니다. (PeerB 기준)\n      peerRef.current.setLocalDescription(answerSdp);\n      console.log('sent the answer');\n      console.log('my offer', answerSdp);\n      socketRef.current.emit('answer', answerSdp, roomID);\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  // rigid control == animate\n  const rigRotation = (\n    vrmRef: React.MutableRefObject<VRM | undefined>,\n    name: keyof typeof VRMSchema.HumanoidBoneName,\n    rotation = { x: 0, y: 0, z: 0 },\n    dampener = 1,\n    lerpAmount = 0.3\n  ) => {\n    if (!vrmRef.current) return\n    const Part = vrmRef.current.humanoid?.getBoneNode(\n      VRMSchema.HumanoidBoneName[name]\n    );\n    if (!Part) {return}\n    \n    let euler = new Euler(\n      rotation.x * dampener,\n      rotation.y * dampener,\n      rotation.z * dampener\n    );\n    let quaternion = new Quaternion().setFromEuler(euler);\n    Part.quaternion.slerp(quaternion, lerpAmount); // interpolate\n  };\n  \n  const rigPosition = (\n    vrmRef: React.MutableRefObject<VRM | undefined>,\n    name: keyof typeof VRMSchema.HumanoidBoneName,\n    position = { x: 0, y: 0, z: 0 },\n    dampener = 1,\n    lerpAmount = 0.3\n  ) => {\n    if (!vrmRef.current) return\n    const Part = vrmRef.current.humanoid?.getBoneNode(\n      VRMSchema.HumanoidBoneName[name]\n    );\n    if (!Part) {return}\n    let vector = new Vector3(\n      position.x * dampener,\n      position.y * dampener,\n      position.z * dampener\n    );\n    Part.position.lerp(vector, lerpAmount); // interpolate\n  };\n  const rigFace = (riggedFace:Kalidokit.TFace, vrmRef: React.MutableRefObject<VRM | undefined>, oldLookTarget: React.MutableRefObject<Euler>) => {\n    if (!vrmRef.current) return\n    rigRotation(vrmRef, \"Neck\", riggedFace.head, 0.7);\n\n    // Blendshapes and Preset Name Schema\n    const Blendshape = vrmRef.current.blendShapeProxy;\n    const PresetName = VRMSchema.BlendShapePresetName;\n    if (!Blendshape || !PresetName) return\n\n    // Simple example without winking. Interpolate based on old blendshape, then stabilize blink with `Kalidokit` helper function.\n    // for VRM, 1 is closed, 0 is open.\n    riggedFace.eye.l = lerp(clamp(1 - riggedFace.eye.l, 0, 1),Blendshape.getValue(PresetName.Blink) ?? 0, .5)\n    riggedFace.eye.r = lerp(clamp(1 - riggedFace.eye.r, 0, 1),Blendshape.getValue(PresetName.Blink) ?? 0, .5)\n    riggedFace.eye = Kalidokit.Face.stabilizeBlink(riggedFace.eye,riggedFace.head.y)\n    Blendshape.setValue(PresetName.Blink, riggedFace.eye.l);\n    \n    // Interpolate and set mouth blendshapes\n    Blendshape.setValue(PresetName.I, lerp(riggedFace.mouth.shape.I,Blendshape.getValue(PresetName.I) ?? 0, .5));\n    Blendshape.setValue(PresetName.A, lerp(riggedFace.mouth.shape.A,Blendshape.getValue(PresetName.A) ?? 0, .5));\n    Blendshape.setValue(PresetName.E, lerp(riggedFace.mouth.shape.E,Blendshape.getValue(PresetName.E) ?? 0, .5));\n    Blendshape.setValue(PresetName.O, lerp(riggedFace.mouth.shape.O,Blendshape.getValue(PresetName.O) ?? 0, .5));\n    Blendshape.setValue(PresetName.U, lerp(riggedFace.mouth.shape.U,Blendshape.getValue(PresetName.U) ?? 0, .5));\n\n    //PUPILS\n    //interpolate pupil and keep a copy of the value\n    let lookTarget =\n      new Euler(\n        lerp(oldLookTarget.current.x, riggedFace.pupil.y, .4),\n        lerp(oldLookTarget.current.y, riggedFace.pupil.x, .4),\n        0,\n        \"XYZ\"\n      )\n    oldLookTarget.current.copy(lookTarget)\n    vrmRef.current.lookAt?.applyer?.lookAt(lookTarget);\n  }\n  // @ts-ignore\n  const onResults: ResultsListener = (results: Results) => {\n    if (!(myCanvasRef.current && myVideoRef.current && myVrmRef.current)) return\n    if (dataChannelRef.current?.readyState === \"open\") dataChannelRef.current?.send(JSON.stringify(results))\n    // Take the results from `Holistic` and animate character based on its Face, Pose, and Hand Keypoints.\n    let riggedPose, riggedLeftHand, riggedRightHand, riggedFace;\n  \n    const faceLandmarks = results.faceLandmarks;\n    // Pose 3D Landmarks are with respect to Hip distance in meters\n    const pose3DLandmarks = results.ea;\n    // Pose 2D landmarks are with respect to videoWidth and videoHeight\n    const pose2DLandmarks = results.poseLandmarks;\n    // Be careful, hand landmarks may be reversed\n    const leftHandLandmarks = results.rightHandLandmarks;\n    const rightHandLandmarks = results.leftHandLandmarks;\n  \n    // Animate Face\n    if (faceLandmarks) {\n      riggedFace = Kalidokit.Face.solve(faceLandmarks,{\n        runtime:\"mediapipe\",\n        video: myVideoRef.current\n      });\n      if (!(riggedFace && myVrmRef)) return\n      // @ts-ignore\n      rigFace(riggedFace, myVrmRef, myOldLookTarget)\n    }\n  \n    // Animate Pose\n    if (pose2DLandmarks && pose3DLandmarks) {\n      riggedPose = Kalidokit.Pose.solve(pose3DLandmarks, pose2DLandmarks, {\n        runtime: \"mediapipe\",\n        video: myVideoRef.current,\n      });\n      if (!riggedPose) return\n      rigRotation(myVrmRef, \"Hips\", riggedPose.Hips.rotation, 0.7);\n      rigPosition(\n        myVrmRef,\n        \"Hips\",\n        {\n          x: -riggedPose.Hips.position.x, // Reverse direction\n          y: riggedPose.Hips.position.y + 1, // Add a bit of height\n          z: -riggedPose.Hips.position.z // Reverse direction\n        },\n        1,\n        0.07\n      );\n  \n      rigRotation(myVrmRef, \"Chest\", riggedPose.Spine, 0.25, .3);\n      rigRotation(myVrmRef, \"Spine\", riggedPose.Spine, 0.45, .3);\n  \n      rigRotation(myVrmRef, \"RightUpperArm\", riggedPose.RightUpperArm, 1, .3);\n      rigRotation(myVrmRef, \"RightLowerArm\", riggedPose.RightLowerArm, 1, .3);\n      rigRotation(myVrmRef, \"LeftUpperArm\", riggedPose.LeftUpperArm, 1, .3);\n      rigRotation(myVrmRef, \"LeftLowerArm\", riggedPose.LeftLowerArm, 1, .3);\n  \n      rigRotation(myVrmRef, \"LeftUpperLeg\", riggedPose.LeftUpperLeg, 1, .3);\n      rigRotation(myVrmRef, \"LeftLowerLeg\", riggedPose.LeftLowerLeg, 1, .3);\n      rigRotation(myVrmRef, \"RightUpperLeg\", riggedPose.RightUpperLeg, 1, .3);\n      rigRotation(myVrmRef, \"RightLowerLeg\", riggedPose.RightLowerLeg, 1, .3);\n    }\n  \n    // Animate Hands\n    if (leftHandLandmarks) {\n      riggedLeftHand = Kalidokit.Hand.solve(leftHandLandmarks, \"Left\");\n      if(!riggedLeftHand || !riggedPose) return\n      rigRotation(myVrmRef, \"LeftHand\", {\n        // Combine pose rotation Z and hand rotation X Y\n        z: riggedPose.LeftHand.z,\n        y: riggedLeftHand.LeftWrist.y,\n        x: riggedLeftHand.LeftWrist.x\n      });\n      rigRotation(myVrmRef, \"LeftRingProximal\", riggedLeftHand.LeftRingProximal);\n      rigRotation(myVrmRef, \"LeftRingIntermediate\", riggedLeftHand.LeftRingIntermediate);\n      rigRotation(myVrmRef, \"LeftRingDistal\", riggedLeftHand.LeftRingDistal);\n      rigRotation(myVrmRef, \"LeftIndexProximal\", riggedLeftHand.LeftIndexProximal);\n      rigRotation(myVrmRef, \"LeftIndexIntermediate\", riggedLeftHand.LeftIndexIntermediate);\n      rigRotation(myVrmRef, \"LeftIndexDistal\", riggedLeftHand.LeftIndexDistal);\n      rigRotation(myVrmRef, \"LeftMiddleProximal\", riggedLeftHand.LeftMiddleProximal);\n      rigRotation(myVrmRef, \"LeftMiddleIntermediate\", riggedLeftHand.LeftMiddleIntermediate);\n      rigRotation(myVrmRef, \"LeftMiddleDistal\", riggedLeftHand.LeftMiddleDistal);\n      rigRotation(myVrmRef, \"LeftThumbProximal\", riggedLeftHand.LeftThumbProximal);\n      rigRotation(myVrmRef, \"LeftThumbIntermediate\", riggedLeftHand.LeftThumbIntermediate);\n      rigRotation(myVrmRef, \"LeftThumbDistal\", riggedLeftHand.LeftThumbDistal);\n      rigRotation(myVrmRef, \"LeftLittleProximal\", riggedLeftHand.LeftLittleProximal);\n      rigRotation(myVrmRef, \"LeftLittleIntermediate\", riggedLeftHand.LeftLittleIntermediate);\n      rigRotation(myVrmRef, \"LeftLittleDistal\", riggedLeftHand.LeftLittleDistal);\n    }\n    if (rightHandLandmarks) {\n      riggedRightHand = Kalidokit.Hand.solve(rightHandLandmarks, \"Right\");\n      if(!riggedRightHand || !riggedPose) return\n      rigRotation(myVrmRef, \"RightHand\", {\n        // Combine Z axis from pose hand and X/Y axis from hand wrist rotation\n        z: riggedPose.RightHand.z,\n        y: riggedRightHand.RightWrist.y,\n        x: riggedRightHand.RightWrist.x\n      });\n      rigRotation(myVrmRef, \"RightRingProximal\", riggedRightHand.RightRingProximal);\n      rigRotation(myVrmRef, \"RightRingIntermediate\", riggedRightHand.RightRingIntermediate);\n      rigRotation(myVrmRef, \"RightRingDistal\", riggedRightHand.RightRingDistal);\n      rigRotation(myVrmRef, \"RightIndexProximal\", riggedRightHand.RightIndexProximal);\n      rigRotation(myVrmRef, \"RightIndexIntermediate\",riggedRightHand.RightIndexIntermediate);\n      rigRotation(myVrmRef, \"RightIndexDistal\", riggedRightHand.RightIndexDistal);\n      rigRotation(myVrmRef, \"RightMiddleProximal\", riggedRightHand.RightMiddleProximal);\n      rigRotation(myVrmRef, \"RightMiddleIntermediate\", riggedRightHand.RightMiddleIntermediate);\n      rigRotation(myVrmRef, \"RightMiddleDistal\", riggedRightHand.RightMiddleDistal);\n      rigRotation(myVrmRef, \"RightThumbProximal\", riggedRightHand.RightThumbProximal);\n      rigRotation(myVrmRef, \"RightThumbIntermediate\", riggedRightHand.RightThumbIntermediate);\n      rigRotation(myVrmRef, \"RightThumbDistal\", riggedRightHand.RightThumbDistal);\n      rigRotation(myVrmRef, \"RightLittleProximal\", riggedRightHand.RightLittleProximal);\n      rigRotation(myVrmRef, \"RightLittleIntermediate\", riggedRightHand.RightLittleIntermediate);\n      rigRotation(myVrmRef, \"RightLittleDistal\", riggedRightHand.RightLittleDistal);\n    }\n  };\n\n  // @ts-ignore\n  const remoteResults = (results: Results) => {\n    if (!(myCanvasRef.current && myVideoRef.current && myVrmRef.current)) return\n    console.log('remote results');\n    // Take the results from `Holistic` and animate character based on its Face, Pose, and Hand Keypoints.\n    let riggedPose, riggedLeftHand, riggedRightHand, riggedFace;\n  \n    const faceLandmarks = results.faceLandmarks;\n    // Pose 3D Landmarks are with respect to Hip distance in meters\n    const pose3DLandmarks = results.ea;\n    // Pose 2D landmarks are with respect to videoWidth and videoHeight\n    const pose2DLandmarks = results.poseLandmarks;\n    // Be careful, hand landmarks may be reversed\n    const leftHandLandmarks = results.rightHandLandmarks;\n    const rightHandLandmarks = results.leftHandLandmarks;\n  \n    // Animate Face\n    if (faceLandmarks) {\n      riggedFace = Kalidokit.Face.solve(faceLandmarks,{\n        runtime:\"mediapipe\",\n      });\n      if (!riggedFace) return\n      rigFace(riggedFace, remoteVrmRef, remoteOldLookTarget)\n    }\n  \n    // Animate Pose\n    if (pose2DLandmarks && pose3DLandmarks) {\n      riggedPose = Kalidokit.Pose.solve(pose3DLandmarks, pose2DLandmarks, {\n        runtime: \"mediapipe\",\n      });\n      if (!riggedPose) return\n      rigRotation(remoteVrmRef, \"Hips\", riggedPose.Hips.rotation, 0.7);\n      rigPosition(\n        remoteVrmRef,\n        \"Hips\",\n        {\n          x: -riggedPose.Hips.position.x, // Reverse direction\n          y: riggedPose.Hips.position.y + 1, // Add a bit of height\n          z: -riggedPose.Hips.position.z // Reverse direction\n        },\n        1,\n        0.07\n      );\n  \n      rigRotation(remoteVrmRef, \"Chest\", riggedPose.Spine, 0.25, .3);\n      rigRotation(remoteVrmRef, \"Spine\", riggedPose.Spine, 0.45, .3);\n  \n      rigRotation(remoteVrmRef, \"RightUpperArm\", riggedPose.RightUpperArm, 1, .3);\n      rigRotation(remoteVrmRef, \"RightLowerArm\", riggedPose.RightLowerArm, 1, .3);\n      rigRotation(remoteVrmRef, \"LeftUpperArm\", riggedPose.LeftUpperArm, 1, .3);\n      rigRotation(remoteVrmRef, \"LeftLowerArm\", riggedPose.LeftLowerArm, 1, .3);\n  \n      rigRotation(remoteVrmRef, \"LeftUpperLeg\", riggedPose.LeftUpperLeg, 1, .3);\n      rigRotation(remoteVrmRef, \"LeftLowerLeg\", riggedPose.LeftLowerLeg, 1, .3);\n      rigRotation(remoteVrmRef, \"RightUpperLeg\", riggedPose.RightUpperLeg, 1, .3);\n      rigRotation(remoteVrmRef, \"RightLowerLeg\", riggedPose.RightLowerLeg, 1, .3);\n    }\n  \n    // Animate Hands\n    if (leftHandLandmarks) {\n      riggedLeftHand = Kalidokit.Hand.solve(leftHandLandmarks, \"Left\");\n      if(!riggedLeftHand || !riggedPose) return\n      rigRotation(remoteVrmRef, \"LeftHand\", {\n        // Combine pose rotation Z and hand rotation X Y\n        z: riggedPose.LeftHand.z,\n        y: riggedLeftHand.LeftWrist.y,\n        x: riggedLeftHand.LeftWrist.x\n      });\n      rigRotation(remoteVrmRef, \"LeftRingProximal\", riggedLeftHand.LeftRingProximal);\n      rigRotation(remoteVrmRef, \"LeftRingIntermediate\", riggedLeftHand.LeftRingIntermediate);\n      rigRotation(remoteVrmRef, \"LeftRingDistal\", riggedLeftHand.LeftRingDistal);\n      rigRotation(remoteVrmRef, \"LeftIndexProximal\", riggedLeftHand.LeftIndexProximal);\n      rigRotation(remoteVrmRef, \"LeftIndexIntermediate\", riggedLeftHand.LeftIndexIntermediate);\n      rigRotation(remoteVrmRef, \"LeftIndexDistal\", riggedLeftHand.LeftIndexDistal);\n      rigRotation(remoteVrmRef, \"LeftMiddleProximal\", riggedLeftHand.LeftMiddleProximal);\n      rigRotation(remoteVrmRef, \"LeftMiddleIntermediate\", riggedLeftHand.LeftMiddleIntermediate);\n      rigRotation(remoteVrmRef, \"LeftMiddleDistal\", riggedLeftHand.LeftMiddleDistal);\n      rigRotation(remoteVrmRef, \"LeftThumbProximal\", riggedLeftHand.LeftThumbProximal);\n      rigRotation(remoteVrmRef, \"LeftThumbIntermediate\", riggedLeftHand.LeftThumbIntermediate);\n      rigRotation(remoteVrmRef, \"LeftThumbDistal\", riggedLeftHand.LeftThumbDistal);\n      rigRotation(remoteVrmRef, \"LeftLittleProximal\", riggedLeftHand.LeftLittleProximal);\n      rigRotation(remoteVrmRef, \"LeftLittleIntermediate\", riggedLeftHand.LeftLittleIntermediate);\n      rigRotation(remoteVrmRef, \"LeftLittleDistal\", riggedLeftHand.LeftLittleDistal);\n    }\n    if (rightHandLandmarks) {\n      riggedRightHand = Kalidokit.Hand.solve(rightHandLandmarks, \"Right\");\n      if(!riggedRightHand || !riggedPose) return\n      rigRotation(remoteVrmRef, \"RightHand\", {\n        // Combine Z axis from pose hand and X/Y axis from hand wrist rotation\n        z: riggedPose.RightHand.z,\n        y: riggedRightHand.RightWrist.y,\n        x: riggedRightHand.RightWrist.x\n      });\n      rigRotation(remoteVrmRef, \"RightRingProximal\", riggedRightHand.RightRingProximal);\n      rigRotation(remoteVrmRef, \"RightRingIntermediate\", riggedRightHand.RightRingIntermediate);\n      rigRotation(remoteVrmRef, \"RightRingDistal\", riggedRightHand.RightRingDistal);\n      rigRotation(remoteVrmRef, \"RightIndexProximal\", riggedRightHand.RightIndexProximal);\n      rigRotation(remoteVrmRef, \"RightIndexIntermediate\",riggedRightHand.RightIndexIntermediate);\n      rigRotation(remoteVrmRef, \"RightIndexDistal\", riggedRightHand.RightIndexDistal);\n      rigRotation(remoteVrmRef, \"RightMiddleProximal\", riggedRightHand.RightMiddleProximal);\n      rigRotation(remoteVrmRef, \"RightMiddleIntermediate\", riggedRightHand.RightMiddleIntermediate);\n      rigRotation(remoteVrmRef, \"RightMiddleDistal\", riggedRightHand.RightMiddleDistal);\n      rigRotation(remoteVrmRef, \"RightThumbProximal\", riggedRightHand.RightThumbProximal);\n      rigRotation(remoteVrmRef, \"RightThumbIntermediate\", riggedRightHand.RightThumbIntermediate);\n      rigRotation(remoteVrmRef, \"RightThumbDistal\", riggedRightHand.RightThumbDistal);\n      rigRotation(remoteVrmRef, \"RightLittleProximal\", riggedRightHand.RightLittleProximal);\n      rigRotation(remoteVrmRef, \"RightLittleIntermediate\", riggedRightHand.RightLittleIntermediate);\n      rigRotation(remoteVrmRef, \"RightLittleDistal\", riggedRightHand.RightLittleDistal);\n    }\n  };\n\n  useEffect(() => {\n    (async () => {\n      \n      if (socketRef.current) return\n      socketRef.current = socketIOClient(SOCKET_URL, {secure: true})\n      // media setting \n      await setMedia()\n\n      await getMyModel()\n      await setMyThree()\n\n      await getRemoteModel()\n      await setRemoteThree()\n      \n      // for while TODO\n      // await holistic.current.send({image: stream});\n      \n      setPeer()\n      setSocket()\n      \n      holisticRef.current.onResults(onResults);\n      setSuccessMyCanvas(true)\n    })()\n\n    return () => {\n      // 언마운트시 socket disconnect\n      if (socketRef.current) {\n        socketRef.current.disconnect();\n      }\n      if (peerRef.current) {\n        peerRef.current.close();\n      }\n      if (streamRef.current) {\n        // 스트림 중지 및 트랙 해제\n        streamRef.current.getTracks().forEach((track) => {\n          track.stop()\n        });\n      }\n    }\n  }, [])\n  useEffect(() => {\n    if (!successMyCanvas) return\n    console.log('start my animate');\n    setSuccessMyCanvas(false)\n    myAnimate()\n  }, [ successMyCanvas ])\n  return (<>\n    <div>Chat desu</div>\n    <table>\n      <thead></thead>\n      <tbody>\n        <tr>\n          <td>Me</td>\n          <td>Another Person</td>\n        </tr>\n        <tr>\n          <td>\n            <canvas ref={myCanvasRef}></canvas>\n          </td>\n          <td>\n            <canvas ref={remoteCanvasRef}></canvas>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <button onClick={checkData}>check!</button>\n    <Link  to=\"/\">back home</Link>\n  </>)\n}\nexport default Chat;\n\n\n"],"names":["SOCKET_URL","concat","process","socketRef","useRef","streamRef","myVideoRef","document","createElement","myCanvasRef","myOldLookTarget","Euler","mySceneRef","Scene","myRendererRef","myOrbitCameraRef","myClockRef","myVrmRef","remoteResultsRef","undefined","remoteCanvasRef","remoteOldLookTarget","remoteSceneRef","remoteRendererRef","remoteOrbitCameraRef","remoteClockRef","remoteVrmRef","_useState","useState","_useState2","_slicedToArray","successMyCanvas","setSuccessMyCanvas","peerRef","RTCPeerConnection","iceServers","urls","holisticRef","dataChannelRef","roomID","useParams","calculateVideo","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","current","send","image","stop","apply","arguments","myAnimate","_ref2","_callee2","_context2","abrupt","update","getDelta","render","remoteAnimate","requestAnimationFrame","_ref3","_callee3","_context3","remoteResults","setMedia","_ref4","_callee5","holistic","myCamera","stream","_context5","Holistic","locateFile","file","sent","setOptions","modelComplexity","smoothLandmarks","minDetectionConfidence","minTrackingConfidence","refineFaceLandmarks","Camera","onFrame","_onFrame","_callee4","_context4","width","height","start","g","srcObject","t0","console","error","getMyModel","_ref5","_callee7","loader","_context7","GLTFLoader","crossOrigin","load","_ref6","_callee6","gltf","_context6","VRMUtils","removeUnnecessaryJoints","scene","VRM","from","then","v","add","rotation","y","Math","PI","_x","progress","log","loaded","total","setMyThree","WebGLRenderer","canvas","alpha","setPixelRatio","window","devicePixelRatio","PerspectiveCamera","position","set","orbitControls","OrbitControls","domElement","screenSpacePanning","target","light","DirectionalLight","normalize","Clock","getRemoteModel","_ref7","_callee9","_context9","_ref8","_callee8","_context8","_x2","setRemoteThree","createOffer","_ref11","_callee12","sdp","_context12","createDataChannel","onmessage","e","JSON","parse","data","onopen","setLocalDescription","emit","createAnswer","_ref12","_callee13","answerSdp","_context13","setRemoteDescription","_x4","rigRotation","vrmRef","name","_vrmRef$current$human","length","x","z","dampener","lerpAmount","Part","humanoid","getBoneNode","VRMSchema","HumanoidBoneName","euler","quaternion","Quaternion","setFromEuler","slerp","rigPosition","_vrmRef$current$human2","vector","Vector3","lerp","rigFace","riggedFace","oldLookTarget","_Blendshape$getValue","_Blendshape$getValue2","_Blendshape$getValue3","_Blendshape$getValue4","_Blendshape$getValue5","_Blendshape$getValue6","_Blendshape$getValue7","_vrmRef$current$lookA","_vrmRef$current$lookA2","head","Blendshape","blendShapeProxy","PresetName","BlendShapePresetName","eye","l","clamp","getValue","Blink","r","Kalidokit","stabilizeBlink","setValue","I","mouth","shape","A","E","O","U","lookTarget","pupil","copy","lookAt","applyer","onResults","results","_dataChannelRef$curre3","_dataChannelRef$curre4","riggedPose","riggedLeftHand","riggedRightHand","readyState","stringify","faceLandmarks","pose3DLandmarks","ea","pose2DLandmarks","poseLandmarks","leftHandLandmarks","rightHandLandmarks","solve","runtime","video","Hips","Spine","RightUpperArm","RightLowerArm","LeftUpperArm","LeftLowerArm","LeftUpperLeg","LeftLowerLeg","RightUpperLeg","RightLowerLeg","LeftHand","LeftWrist","LeftRingProximal","LeftRingIntermediate","LeftRingDistal","LeftIndexProximal","LeftIndexIntermediate","LeftIndexDistal","LeftMiddleProximal","LeftMiddleIntermediate","LeftMiddleDistal","LeftThumbProximal","LeftThumbIntermediate","LeftThumbDistal","LeftLittleProximal","LeftLittleIntermediate","LeftLittleDistal","RightHand","RightWrist","RightRingProximal","RightRingIntermediate","RightRingDistal","RightIndexProximal","RightIndexIntermediate","RightIndexDistal","RightMiddleProximal","RightMiddleIntermediate","RightMiddleDistal","RightThumbProximal","RightThumbIntermediate","RightThumbDistal","RightLittleProximal","RightLittleIntermediate","RightLittleDistal","useEffect","_callee14","_context14","socketIOClient","secure","addTrack","getTracks","onicecandidate","candidate","ondatachannel","channel","ontrack","room","on","allUsers","_ref9","_callee10","_context10","addIceCandidate","_x3","_callee11","_context11","disconnect","close","forEach","track","_jsxs","_Fragment","children","_jsx","ref","onClick","_dataChannelRef$curre","_dataChannelRef$curre2","preventDefault","Link","to"],"sourceRoot":""}